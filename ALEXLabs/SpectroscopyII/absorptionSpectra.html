<!DOCTYPE html>
<html>
<link rel="stylesheet" href="../ALEX.css">
<link rel="stylesheet" href="./css/spectroscopy.css">

<meta http-equiv='cache-control' content='no-cache'> 
<meta http-equiv='expires' content='0'> 
<meta http-equiv='pragma' content='no-cache'>

<meta name="viewport" content="width=device-width, initial-scale=1">

<head>
<style>
.modalWhiteBckgrd {
  border: 1vw solid white;
  background-color:lightgray;
  border-radius:5px;
  padding:10px;
  margin-top:10px;
  margin-bottom:10px;
  max-width:120ch;
}
</style>

<script>
function SpecHome() {
  window.open('AstronomicalSpectroscopy.html','_self');
}
</script>

</head>

<header>
  <title>Absorption Spectra</title>
  <button class = "button biggerButton" onclick="SpecHome()">Main Menu</button>
</header>

<body>
<div class="body">

  <div class="AstrSpectroscopy center" id="contain1">

    <h1>Absorption Spectra</h1> 

    <p>Welcome to the absorption spectra! This experiment is to look at absorption lines within a gas!</p>
 
    <label for="whichGas">Choose a gas:</label>
    <select name="whichGas" id="whichGas" onchange = "switchGas()">
        <option value="mystery1">Mystery Gas 1</option>
        <option value="mystery2">Mystery Gas 2</option>
        <option value="mystery3">Mystery Gas 3</option>
        <option value="mystery4">Mystery Gas 4</option>
      </optgroup>
    </select>
    
    <br><br>    

    <button onclick="showReference()" class="AstrSpecButton center">Show Reference Spectra</button>

  </div>

  <canvas class="center" id="canvas" height="500" width="750"></canvas> <br>
  <input class="center" id="repeats" type = "number" placeholder="# Photons" min="0" max="20"/> 
 
  <input type="button" onclick="start()" value="Start!" class="center"/>
 
  <div class="modal" id="myModal" style="display:none;min-width:50ch;">
    <div class="modalContent modalWhiteBckgrd center" style="width:60%;">
      <h2 style="color:black;">Reference Spectra</h2>

      <img src="mysterySpectra.png" width=45% class="center" style="aspect-ratio:9/11;"/>

      <p style="color:black;">Click anywhere outside this box to exit</p>
      <p id = "clickLocation"></p>
    </div>
  </div>

  <p id="display"> </p>

  <div class="AstrSpectroscopy center" id = "contain2">

    <h2>Use this slider to set the photon energy</h2>
    <div class="slidecontainer">
      <input type="range" min="1.6" max="3.5" value="2.5" step="0.1" class="slider" id="myRange">
      <h2 style="color:darkgreen;">Energy: <span id="energy"></span> eV</h2>
    </div>

    <h2 style="text-align:left;">Results:</h2>
    
    <p id="displayResult">Observed: <span id="numObs">X</span> out of <span id="numEmit">Y</span></h2></p>

    <h2 style="color:darkgreen;"><span id="number"></span> <span id="finish"> </span> </h2>
    <!-- There is probably a better way to do this, but I do not know it -->
    <p style="color:green;"><span id="prevNum1"></span> <span id="prev1"></span></p>
    <p style="color:green;"><span id="prevNum2"></span> <span id="prev2"></span></p>
    <p style="color:green;"><span id="prevNum3"></span> <span id="prev3"></span></p>
    <p style="color:green;"><span id="prevNum4"></span> <span id="prev4"></span></p>
    <p style="color:green;"><span id="prevNum5"></span> <span id="prev5"></span></p>
    <p style="color:green;"><span id="prevNum6"></span> <span id="prev6"></span></p>
    <p style="color:green;"><span id="prevNum7"></span> <span id="prev7"></span></p>
    <p style="color:green;"><span id="prevNum8"></span> <span id="prev8"></span></p>
    <p style="color:green;"><span id="prevNum9"></span> <span id="prev9"></span></p>
    <p style="color:green;"><span id="prevNum10"></span> <span id="prev10"></span></p>
    <p style="color:green;"><span id="prevNum11"></span> <span id="prev11"></span></p>
    <p style="color:green;"><span id="prevNum12"></span> <span id="prev12"></span></p>
    <p style="color:green;"><span id="prevNum13"></span> <span id="prev13"></span></p>
    <p style="color:green;"><span id="prevNum14"></span> <span id="prev14"></span></p>
    <p style="color:green;"><span id="prevNum15"></span> <span id="prev15"></span></p>
    <p style="color:green;"><span id="prevNum16"></span> <span id="prev16"></span></p>
    <p style="color:green;"><span id="prevNum17"></span> <span id="prev17"></span></p>
    <p style="color:green;"><span id="prevNum18"></span> <span id="prev18"></span></p>
    <p style="color:green;"><span id="prevNum19"></span> <span id="prev19"></span></p>
    <p style="color:green;"><span id="prevNum20"></span> <span id="prev20"></span></p>

  </div>

</body>

<script src="./js/helperFunctions.js"></script>
<script src="./js/wavelengthToColor.js"></script>
<script src="./js/absorptionSpectra.js"></script>
<script src="./js/absorptionSpectraConstants.js"></script>
<script>
// Get all options for gasses (i.e. Mystery1, Mystery2...)
var options = document.getElementById('whichGas').selectedOptions;
var values = Array.from(options).map(({ value }) => value);
values = String(values);

// Defaults to first mystery gas
var unlikelyEnergies = allGasEnergy[values];  
var weakUnlikelyEnergies = allGasWeak[values];

// Handles switching mystery gasses
function switchGas () {
  values = Array.from(options).map(({ value }) => value);
  whichGas = String(values);
  unlikelyEnergies = allGasEnergy[whichGas]
  weakUnlikelyEnergies = allGasWeak[whichGas]
}
  
// Get default energy
var slider = document.getElementById("myRange");
var output = document.getElementById("energy");
output.innerHTML = slider.value;

// Change all borders colors to default wavelength
var WL = wavelengtheVConverter(document.getElementById("energy").innerHTML);
var color = wavelengthToColor(WL);    
document.getElementById("energy").style.color = color;
document.getElementById("contain1").style.borderColor = color;
document.getElementById("contain2").style.borderColor = color;

// Change the wavelegth on slider change
slider.oninput = function() {
  output.innerHTML = this.value;
  var WL = wavelengtheVConverter(document.getElementById("energy").innerHTML);
  var color = wavelengthToColor(WL);    

  document.getElementById("energy").style.color = color; 
  document.getElementById("contain1").style.borderColor = color;
  document.getElementById("contain2").style.borderColor = color;
}

// Handle bringing up the reference spectra
var modal = document.getElementById("myModal");
window.onclick = function(event) {
 if (event.target == modal) {
    modal.style.display = "none";
 }
}
function showReference() {
  refDiv = document.getElementById("myModal")
  refDiv.style.display = refDiv.style.display != 'none' ? 'none' : 'block';
}
</script>

</html>
