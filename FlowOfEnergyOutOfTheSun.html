<!DOCTYPE html>
<html>
<link rel="stylesheet" href="style.css">

<meta http-equiv='cache-control' content='no-cache'> 
<meta http-equiv='expires' content='0'> 
<meta http-equiv='pragma' content='no-cache'>

<script src="scripts.js"></script>

<head>
<style>
* {
  box-sizing:border-box;
}
.column {
  float:left;
  width:50%;
}

.row:after {
  contents: "";
  display: table;
  clear: both;
}

p {
  color:steelblue;
  font-size:14pt;
}

h1 {
  font-size:30pt;
}

h2 {
  font-size:18pt;
}

button {
  background-color:black;
  color:steelblue;
  border: 1px solid tomato;
  padding: 8px;
  font-size: 12pt;
}

button:hover {
  background-color:steelblue;
  color:black;
}

input:hover {
  background-color:steelblue;
  color:black;
}

.column3 {
  float:left;
  width:33%;
}

img:hover {
  width=110%;
}
#canvas {
  border: 1px solid black;
}

</style>

<script src="https://cdn.plot.ly/plotly-2.11.1.min.js"></script>
<script src="plotly-2.11.1.min.js"></script>

</head>


<body>
<form name = "converter">
<div class="body">

   <h1>Flow Of Energy Out Of The Sun </h2> 

  <p style="color:white;">Welcome to the flow of energy out of the sun! This first experiment is to understand the random walk through the Sun!</p>

  <canvas class="center" id="canvas" height="500" width="750"></canvas> <br>
  <input type="button" onclick="start()" value="Start!" class="center"/>
  <h2>Number of walks:</h2>
  <p id="display"> </p>
  <p id="finish" style="color:orange;font-size:25pt;"> </p><br>

  

</form>


</body>

<script>
    // Based on code found here: https://gist.github.com/hacknightly/fd609abe5a7e15e223a823ee6e0724c8
    let x = 375;
    let y = 250;
    var counter = document.querySelector('canvas');
    var number = 0;

    function random(min, max) {
      return Math.random() * (max - min) + min;
    }

    function init() {
      window.requestAnimationFrame(draw);
    }

    function draw() {
      number++;
      counter.textContext = number;
      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');    

      const disp = document.getElementById('display');
      document.getElementById("display").innerHTML = number;

      ctx.strokeStyle = 'yellow';
      ctx.beginPath();
      ctx.arc(375, 250, 200, 0, 2 * Math.PI);
      ctx.lineWidth = 3;
      ctx.stroke();
      ctx.beginPath();
      ctx.strokeStyle = 'red';
      ctx.arc(375, 250, 15, 0, 2 * Math.PI);
      ctx.stroke();
      ctx.beginPath();
      ctx.strokeStyle = 'orange';
      ctx.arc(375, 250, 150, 0, 2 * Math.PI);
      ctx.stroke();

      ctx.strokeStyle = 'white';
      ctx.beginPath();
      ctx.moveTo(x, y);
      if ( ((x-375)**2 + (y-250)**2)**(1/2) < 15 ) {
        pertx = random(-2.5, 2.5);
        perty = random(-2.5, 2.5);
      } else if ( ((x-375)**2 + (y-250)**2)**(1/2) < 150 ) {
        pertx = random(-5, 5);
        perty = random(-5, 5);
      } else {
        pertx = random(-10, 10);
        perty = random(-10, 10);
      }
      ctx.strokeStyle = 'white';
      ctx.lineWidth = 2;
      ctx.lineTo(x+pertx, y+perty);
      ctx.stroke();

      x += pertx;
      y += perty;
      if ( ((x-375)**2 + (y-250)**2)**(1/2) > 200 ) {
        document.getElementById("display").innerHTML = number;
        document.getElementById("finish").innerHTML = "Photon has escaped the sun!";
      }
      else {
        window.requestAnimationFrame(draw);
      }
    }
    
    function start() {
	const canvas = document.getElementById('canvas');
	const context = canvas.getContext('2d');

	context.clearRect(0, 0, canvas.width, canvas.height);

         x = 375;
         y = 250;
         number = 0;
         document.getElementById("display").innerHTML = 0;
         document.getElementById("finish").innerHTML = "";
	init();
    }
    
    
  </script>

</html>
